# Копирование объектов и ссылки

#### [Копирование объектов и ссылки](https://learn.javascript.ru/object-copy)

Одним из фундаментальных отличий объектов от примитивных типов данных является то, что они хранятся и копируются «по
ссылке».

Примитивные типы: строки, числа, логические значения – присваиваются и копируются «по значению».

**Переменная хранит не сам объект, а его «адрес в памяти», другими словами «ссылку» на него.**

**Когда переменная объекта копируется – копируется ссылка, сам же объект не дублируется.**

### Сравнение по ссылке

Операторы равенства == и строгого равенства === для объектов работают одинаково.

**Два объекта равны только в том случае, если это один и тот же объект.**

Для сравнений типа obj1 > obj2 или для сравнения с примитивом obj == 5 объекты преобразуются в примитивы. По правде
говоря, сравнения такого рода необходимы очень редко и обычно являются результатом ошибки программиста.

### Клонирование и объединение объектов, Object.assign

Но если мы действительно этого хотим, то нам нужно создавать новый объект и повторять структуру дублируемого объекта,
перебирая его свойства и копируя их.

Например так:

    let user = {`
      name: "Иван",
      age: 30
    };
  
    let clone = {}; // новый пустой объект
    
    // скопируем все свойства user в него
    for (let key in user) {
      clone[key] = user[key];
    }
    
    // теперь в переменной clone находится абсолютно независимый клон объекта
    clone.name = "Пётр"; // изменим в нём данные
    
    alert( user.name ); // в оригинальном объекте значение свойства `name` осталось прежним – Иван.

Кроме того, для этих целей мы можем использовать
метод [Object.assign](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/Object/assign).

    Object.assign(dest, [src1, src2, src3...])

- Первый аргумент `dest` — целевой объект.
- Остальные аргументы `src1, ..., srcN` (может быть столько, сколько нужно) являются исходными объектами
- Метод копирует свойства всех исходных объектов `src1, ..., srcN` в целевой объект `dest`. То есть, свойства всех
  перечисленных объектов, начиная со второго, копируются в первый объект.
- Возвращает объект `dest`.

### Вложенное клонирование

`Object.assign` не делает глубокое клонирование объекта. Если внутри копируемого объекта есть свойство, значение
которого не является примитивом, оно будет передано по ссылке.
Мы можем реализовать глубокое клонирование, используя рекурсию. Или, чтобы не изобретать велосипед, использовать готовую
реализацию — метод _[.cloneDeep(obj)](https://lodash.com/docs#cloneDeep) из
JavaScript-библиотеки [lodash](https://lodash.com/).


